generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["public"]
}

model User {
  id                 Int      @id @default(autoincrement())
  full_name          String
  phone_number       String?  @unique
  password           String
  block_no           String?
  apartment_no       String?
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt
  siteId             Int
  site               Site     @relation(fields: [siteId], references: [id])
  is_verified            Boolean   @default(false)
  phone_verification_code String? 
  code_expiry            DateTime? 

  @@map("users")
  @@schema("public")
}

model Admin {
  id                 Int         @id @default(autoincrement())
  full_name          String
  email              String      @unique
  password           String
  account_type       AccountType
  company_name       String?
  created_at         DateTime    @default(now())
  updated_at         DateTime    @updatedAt
  sites_created      Site[]
  is_verified         Boolean   @default(false)
  verificationToken   String?   @unique
  tokenExpiry         DateTime?
  
  @@map("admins")
  @@schema("public")
}

model Site {
  id                 Int             @id @default(autoincrement())
  site_id            String          @unique
  site_name          String
  site_address       String
  created_at         DateTime        @default(now())
  updated_at         DateTime        @updatedAt
  adminId            Int
  admin              Admin           @relation(fields: [adminId], references: [id])
  announcements      Announcements[]
  users              User[]

  @@map("sites")
  @@schema("public")
}

model Announcements {
  id         Int      @id @default(autoincrement())
  title      String
  content    String
  created_at DateTime @default(now())
  updated_at DateTime
  siteId     Int
  start_date DateTime
  end_date   DateTime
  site       Site     @relation(fields: [siteId], references: [id], onDelete: Cascade)

  @@schema("public")
}

enum AccountType {
  INDIVIDUAL
  COMPANY

  @@schema("public")
}

